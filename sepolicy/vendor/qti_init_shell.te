# RFS
typeattribute qti_init_shell data_between_core_and_vendor_violators;

allow qti_init_shell { sysfs sysfs_dm }:file write;

allow qti_init_shell default_prop:file { open read getattr };
allow qti_init_shell system_prop:file { open read };
allow qti_init_shell system_prop:property_service set;
allow qti_init_shell vendor_data_file:dir { open read write create add_name setattr remove_name };
allow qti_init_shell vendor_data_file:file { read write getattr open create setattr unlink };
allow qti_init_shell self:capability { dac_override };

allow qti_init_shell configfs:dir { read write create add_name };
allow qti_init_shell configfs:lnk_file { read write create };
allow qti_init_shell sensors_vendor_data_file:dir { search open getattr read };
allow qti_init_shell configfs:file create_file_perms;
allow qti_init_shell ctl_stop_prop:property_service { set };
allow qti_init_shell proc_extra_free_kbytes:file rw_file_perms;
allow qti_init_shell fih_partition:blk_file { read };

allow qti_init_shell sensors_persist_file:fifo_file { getattr setattr };
allow qti_init_shell sysfs:file setattr;

allow qti_init_shell sysfs_leds:dir setattr;
allow qti_init_shell sysfs_leds:file setattr;
dontaudit qti_init_shell sysfs:dir setattr;

set_prop(qti_init_shell, system_prop)
set_prop(qti_init_shell, exported2_system_prop)
set_prop(qti_init_shell, exported_system_radio_prop)
set_prop(qti_init_shell, vendor_am_prop)
